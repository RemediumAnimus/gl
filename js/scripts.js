$(document).ready(function(){!function(){function e(e){var i={date:e.date||"",title:e.title||"",preview:e.preview||"",url:e.url||"",image:e.image||""};if(i.image)var t='<div class="n-item"><a href='+i.url+'></a><div class="n-item__pic"><img src='+i.image+' alt=""></div><div class="n-item__info"><div class="n-item__date">'+i.date+'</div><div class="n-item__head">'+i.title+'.</div><div class="n-item__text">'+i.preview+"</div></div></div>";else var t='<div class="n-item"><a href='+i.url+'></a><div class="n-item__info"><div class="n-item__date">'+i.date+'</div><div class="n-item__head">'+i.title+'.</div><div class="n-item__text">'+i.preview+"</div></div></div>";return t}var i=!1;$(".n-link").click(function(e){e.preventDefault();var i=$(this).attr("href");$("html, body").stop().animate({scrollTop:$(i).offset().top},1e3)}),$(".load").click(function(){if(!i){var t=$(this),a=new XMLHttpRequest;a.open("GET","news.json",!0),a.send(),a.onreadystatechange=function(){if(4==a.readyState)if(200!=a.status)console.log(a.status+": "+a.statusText);else{for(var s=JSON.parse(a.responseText),n=0;n<s.news.length;n++){var l=e(s.news[n]);$(".n-items").append(l)}t.hide(),i=!0}}}}),$(".open-pop").click(function(e){e.preventDefault(),$.magnificPopup.open({items:{src:"#pop-alarm"},type:"inline",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeOnBgClick:!0,closeBtnInside:!0,preloader:!1,closeMarkup:"",midClick:!0,removalDelay:300,mainClass:"my-mfp-slide-bottom"})}),$(".n-pop__close").click(function(){$.magnificPopup.close()}),$("#tel").inputmask({mask:"9(999) 999-9999"}),$("#email").inputmask({mask:"*{1,20}[.*{1,20}][.*{1,20}][.*{1,20}]@*{1,20}[.*{2,6}][.*{1,2}]",greedy:!1,onBeforePaste:function(e,i){return e=e.toLowerCase(),e.replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"}}}),$("#form").validate({rules:{name:"required",message:"required",tel:{required:function(e){return!$("#email").val()}},email:{required:function(e){return!$("#tel").val()}}},messages:{name:"Введите имя",message:"Введите сообщение",email:"Введите email",tel:"Введите номер телефона"},submitHandler:function(e){$.ajax({type:"GET",url:"success.json",data:$("#form").serialize(),success:function(e){$(".n-resH").html(e.msg),console.log(e),$.magnificPopup.close(),setTimeout(function(){$.magnificPopup.open({items:{src:"#pop-res"},type:"inline",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeOnBgClick:!0,closeBtnInside:!0,preloader:!1,closeMarkup:"",midClick:!0,removalDelay:300,mainClass:"my-mfp-slide-bottom"})},1e3)}})}})}()});